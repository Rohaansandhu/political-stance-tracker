
# United States Political Stance Tracker
Analyzes voting records to show where US Congress Members stand on major political issues and spectrums. Built upon the amazing tools of [unitedstates/congress](https://github.com/unitedstates/congress).

## Setup
Clone this repo and install dependencies in a virtual environment:
```bash
python3 -m venv env
source env/bin/activate
pip install -r requirements.txt
```

**LLM API Key Required:**
To use the bill analysis features, you must create your own [OpenRouter](https://openrouter.ai/) API key and set it as an environment variable. This allows you to use the LLM of your choice for bill analysis.

1. Sign up at [OpenRouter](https://openrouter.ai/) and obtain your API key.
2. Set your API key in your .env file or run this (replace `YOUR_API_KEY`):
	```bash
	export OPENROUTER_API_KEY=YOUR_API_KEY
	```
3. You can now use the LLM-powered scripts in this project.

Make sure the congress project is cloned as a submodule inside this repo.
Follow the [congress repo instructions](https://github.com/unitedstates/congress) to download all necessary packages and tools.

## Usage

### 0. Fetch Roll Call Data
Using the [unitedstates/congress](https://github.com/unitedstates/congress) submodule, run:
```bash
usc-run votes
```
Output: `data/{congress}/votes`

This will download all voting roll call data. You can specify congress or session with the --congress or --session flags. Please make sure you run this command in the top-level directory so the data populates in the correct folder.

### 1. Fetch Current Legislators
Downloads the latest legislator information and saves it locally as JSON:
```bash
python3 get_current_legislators.py
```
Output: `data/current-legislators.json`

### 2. Process Votes by Member
Parses all roll call votes for the current Congress and outputs one JSON file per legislator containing their voting record:
```bash
python3 process_votes_by_member.py
```
Output: `data/organized_votes/{member_id}.json`

### 3. Get Voted Bills
Fetches bill status for all bills that have been voted on and marks them accordingly. Also generates `data.json` files for bill XML data.
```bash
python3 get_voted_bills.py [--force]
```
Use `--force` to re-download and re-parse all bill data.

### 4. Generate Bill Analyses
Analyzes bills using an LLM and generates a `bill_analysis.json` for each voted bill.
```bash
python3 generate_bill_analysis.py [--force]
```
Use `--force` to overwrite existing analyses.

### 5. Calculate Member Ideology
Processes all legislators and calculates ideology scores based on their voting records and bill analyses.
```bash
python3 calc_member_ideology.py
```
Output: `data/legislator_profiles/{member_id}.json`


### 6. Member Ranking
Ranks legislators by political spectrums and categories, generates summary reports and CSV exports.
```bash
python3 member_ranking.py
```
Outputs:
- `data/rankings/all_rankings.json` (full rankings)
- `data/rankings/extremes_summary.json` (summary of most extreme legislators)
- `data/rankings/csv/` (CSV exports)

### 7. Visualize Rankings
Generates plots and visualizations from the CSV ranking outputs. Plots are saved in `data/rankings/csv/plots/`.
```bash
python3 visualize_rankings.py
```
Outputs:
- Boxplots of ideological score distributions by party for each ranking
- Scatter plots of rank vs. score, colored by party
- All plots saved as PNG files in `data/rankings/csv/plots/`

## Data Output
All outputs are stored in the generated `data/` folder and its subdirectories.

## Current State & TODOs
This project is actively under development. The following features and improvements are planned or in progress:

- **Store ideology outputs in a Relational DB:** Enhance query and graphing capabilities by creating rigid schemas, allowing for more complex data analysis. <br>
  *Progress: Not started.*
- **Use MongoDB to store raw data:** Improve data storage by storing the raw json outputs from both the Congress scrapers and the LLM into MongoDB. <br>
  *Progress: Script to load existing data from data/ into the db has been created. Will add options for current scripts to output directly into db.*
- **Refine bill analysis LLM prompts:** Improve the quality and consistency of bill analyses generated by the LLM. LLM responses vary by nature, but by creating a proper frame and structure, and by adjusting model temperatures, a more predictable and accurate response can be achieved. <br>
  *Progress:Added versioning to model prompts, put temperature at 0. Refined the categories and spectrums, gave partisan and impact scores to both.*
- **Resolve data irregularities:** Address issues with current rankings and political stances to ensure accuracy and reliability. Spectrum ranges are extremely variable. Libertarian and Authoritarian leanings need to be implemented better. <br>
  *Progress: Bill votes for small amendment changes happen often. Now only the bill votes on passage are included. Political categories and spectrums still need more vetting and additions.*
- **Add graphs and visualizations:** Integrate graphical outputs to better illustrate findings and trends. <br>
  *Progress: Added two scripts to generate csvs and graphs (boxplots and scatterplots).*
- **Add results folder for findings:** Create a dedicated folder to store summary results, visualizations, and key insights generated to show this tool's output. <br>
  *Progress: Will add soon for initial findings. Once more data is crunched and organized, the results will be made public. The plan is to gather data from the 113th to 119th congress.*

If you have suggestions or want to contribute, feel free to open an issue or pull request!

## Acknowledgments
Special thanks to the [unitedstates/congress](https://github.com/unitedstates/congress) project for providing the House and Senate scrapers that make this project possible.
